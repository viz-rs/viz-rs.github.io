<article class=flex-1><h1 id=extractors>Extractors<a class=anchor href=#extractors>#</a></h1><p>The purpose of the extractor is to extract data from HTTP requests.</p><h2 id=interface-definition>Interface definition<a class=anchor href=#interface-definition>#</a></h2><div class=code><button class="i-lucide-copy transition w-4 h-4 select-none absolute top-4 right-2 op-20 hover:op-80"></button><pre class=language-rust><code><span class=line><span class=punctuation.bracket>#</span><span class=punctuation.bracket>[</span><span class=function.macro>async_trait</span><span class=punctuation.bracket>]</span>
</span><span class=line><span class=keyword>pub</span> <span class=keyword>trait</span> <span class=type>FromRequest</span>: <span class=type>Sized</span> <span class=punctuation.bracket>{</span>
</span><span class=line>    <span class=comment>/// Return error message when extraction fails</span>
</span><span class=line>    <span class=keyword>type</span> <span class=type>Error</span>: <span class=type>IntoResponse</span><span class=punctuation.delimiter>;</span>
</span><span class=line>
</span><span class=line>    <span class=comment>/// Extracts data from an HTTP request and returns that type</span>
</span><span class=line>    <span class=punctuation.bracket>#</span><span class=punctuation.bracket>[</span><span class=function.macro>must_use</span><span class=punctuation.bracket>]</span>
</span><span class=line>    <span class=keyword>async</span> <span class=keyword.function>fn</span> <span class=function>extract</span><span class=punctuation.bracket>(</span><span class=parameter>req</span>: <span class=keyword>&</span><span class=keyword>mut</span> <span class=type>Request</span><span class=punctuation.bracket>)</span> <span class=operator>-></span> <span class=type>Result</span><span class=punctuation.bracket><</span><span class=type>Self</span><span class=punctuation.delimiter>,</span> <span class=type>Self</span><span class=punctuation.delimiter>::</span><span class=type>Error</span><span class=punctuation.bracket>></span><span class=punctuation.delimiter>;</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span></code></pre></div><h2 id=extraction-functions>Extraction functions<a class=anchor href=#extraction-functions>#</a></h2><p>Information is extracted via the <a href=https://docs.rs/viz/0.4.x/viz/trait.RequestExt.html#tymethod.extract><code>extract</code></a> function.</p><div class=code><button class="i-lucide-copy transition w-4 h-4 select-none absolute top-4 right-2 op-20 hover:op-80"></button><pre class=language-rust><code><span class=line><span class=keyword>async</span> <span class=keyword.function>fn</span> <span class=function>show_user</span><span class=punctuation.bracket>(</span><span class=keyword>mut</span> <span class=parameter>req</span>: <span class=type>Request</span><span class=punctuation.bracket>)</span> <span class=operator>-></span> <span class=type>Result</span><span class=punctuation.bracket><</span><span class=type>Response</span><span class=punctuation.bracket>></span> <span class=punctuation.bracket>{</span>
</span><span class=line>  <span class=keyword>let</span> <span class=variable>id</span> <span class=operator>=</span> <span class=parameter>req</span><span class=punctuation.delimiter>.</span><span class=function>extract</span><span class=punctuation.delimiter>::</span><span class=punctuation.bracket><</span><span class=type>Params</span><span class=punctuation.bracket><</span><span class=type.builtin>u32</span><span class=punctuation.bracket>></span><span class=punctuation.bracket>></span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>.</span><span class=keyword.return>await</span>?<span class=punctuation.delimiter>;</span>
</span><span class=line>  <span class=type>Ok</span><span class=punctuation.bracket>(</span><span class=type>Response</span><span class=punctuation.delimiter>::</span><span class=function>text</span><span class=punctuation.bracket>(</span><span class=function.macro>format</span><span class=function.macro>!</span><span class=punctuation.bracket>(</span><span class=string>"id: {id}"</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span></code></pre></div><p>The <a href=https://docs.rs/viz/0.4.x/viz/trait.RequestExt.html#tymethod.extract><code>extract</code></a> function can also take a tuple type, and up to 12 type elements can be added to the tuple.</p><div class=code><button class="i-lucide-copy transition w-4 h-4 select-none absolute top-4 right-2 op-20 hover:op-80"></button><pre class=language-rust><code><span class=line><span class=punctuation.bracket>#</span><span class=punctuation.bracket>[</span><span class=function.macro>derive</span><span class=punctuation.bracket>(</span><span class=type>Debug</span>, <span class=type>Deserialize</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>]</span>
</span><span class=line><span class=keyword>struct</span> <span class=type>Pagination</span> <span class=punctuation.bracket>{</span>
</span><span class=line>    <span class=keyword>pub</span> <span class=variable>offset</span>: <span class=type>Option</span><span class=punctuation.bracket><</span><span class=type.builtin>usize</span><span class=punctuation.bracket>></span><span class=punctuation.delimiter>,</span>
</span><span class=line>    <span class=keyword>pub</span> <span class=variable>limit</span>: <span class=type>Option</span><span class=punctuation.bracket><</span><span class=type.builtin>usize</span><span class=punctuation.bracket>></span><span class=punctuation.delimiter>,</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span><span class=line>
</span><span class=line><span class=keyword>async</span> <span class=keyword.function>fn</span> <span class=function>show_more</span><span class=punctuation.bracket>(</span><span class=keyword>mut</span> <span class=parameter>req</span>: <span class=type>Request</span><span class=punctuation.bracket>)</span> <span class=operator>-></span> <span class=type>Result</span><span class=punctuation.bracket><</span><span class=type>Response</span><span class=punctuation.bracket>></span> <span class=punctuation.bracket>{</span>
</span><span class=line>  <span class=keyword>let</span> <span class=punctuation.bracket>(</span><span class=variable>id</span><span class=punctuation.delimiter>,</span> <span class=constructor>Query</span><span class=punctuation.bracket>(</span><span class=constructor>Pagination</span> <span class=punctuation.bracket>{</span> <span class=variable>offset</span><span class=punctuation.delimiter>,</span> <span class=variable>limit</span> <span class=punctuation.bracket>}</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span> <span class=operator>=</span>
</span><span class=line>      <span class=parameter>req</span><span class=punctuation.delimiter>.</span><span class=function>extract</span><span class=punctuation.delimiter>::</span><span class=punctuation.bracket><</span><span class=punctuation.bracket>(</span><span class=type>Params</span><span class=punctuation.bracket><</span><span class=type.builtin>u32</span><span class=punctuation.bracket>></span><span class=punctuation.delimiter>,</span> <span class=type>Query</span><span class=punctuation.bracket><</span><span class=type>Pagination</span><span class=punctuation.bracket>></span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>></span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>.</span><span class=keyword.return>await</span>?<span class=punctuation.delimiter>;</span>
</span><span class=line>  <span class=type>Ok</span><span class=punctuation.bracket>(</span><span class=type>Response</span><span class=punctuation.delimiter>::</span><span class=function>text</span><span class=punctuation.bracket>(</span><span class=function.macro>format</span><span class=function.macro>!</span><span class=punctuation.bracket>(</span><span class=string>"id: {id}, offset: {offset}, limit: {limit}"</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span></code></pre></div><h2 id=custom-types>Custom Types<a class=anchor href=#custom-types>#</a></h2><p>The <a href=https://docs.rs/viz/0.4.x/viz/trait.FromRequest.html><code>FromRequest</code></a> feature is implemented to extract information by defining new types.</p><div class=code><button class="i-lucide-copy transition w-4 h-4 select-none absolute top-4 right-2 op-20 hover:op-80"></button><pre class=language-rust><code><span class=line><span class=punctuation.bracket>#</span><span class=punctuation.bracket>[</span><span class=function.macro>derive</span><span class=punctuation.bracket>(</span><span class=type>Debug</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>]</span>
</span><span class=line><span class=keyword>struct</span> <span class=type>RequestInfo</span> <span class=punctuation.bracket>{</span>
</span><span class=line>    <span class=keyword>pub</span> <span class=variable>method</span>: <span class=type>String</span><span class=punctuation.delimiter>,</span>
</span><span class=line>    <span class=keyword>pub</span> <span class=variable>path</span>: <span class=type>String</span><span class=punctuation.delimiter>,</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span><span class=line>
</span><span class=line><span class=punctuation.bracket>#</span><span class=punctuation.bracket>[</span><span class=function.macro>async_trait</span><span class=punctuation.bracket>]</span>
</span><span class=line><span class=keyword>impl</span><span class=punctuation.bracket><</span><span class=type>T</span><span class=punctuation.bracket>></span> <span class=type>FromRequest</span> <span class=keyword>for</span> <span class=type>RequestInfo</span>
</span><span class=line><span class=punctuation.bracket>{</span>
</span><span class=line>    <span class=keyword>type</span> <span class=type>Error</span> <span class=operator>=</span> <span class=type>Infallible</span><span class=punctuation.delimiter>;</span>
</span><span class=line>
</span><span class=line>    <span class=keyword>async</span> <span class=keyword.function>fn</span> <span class=function>extract</span><span class=punctuation.bracket>(</span><span class=parameter>req</span>: <span class=keyword>&</span><span class=keyword>mut</span> <span class=type>Request</span><span class=punctuation.bracket>)</span> <span class=operator>-></span> <span class=type>Result</span><span class=punctuation.bracket><</span><span class=type>Self</span><span class=punctuation.delimiter>,</span> <span class=type>Self</span><span class=punctuation.delimiter>::</span><span class=type>Error</span><span class=punctuation.bracket>></span> <span class=punctuation.bracket>{</span>
</span><span class=line>        <span class=type>Ok</span><span class=punctuation.bracket>(</span><span class=type>RequestInfo</span> <span class=punctuation.bracket>{</span>
</span><span class=line>            <span class=variable>method</span>: <span class=parameter>req</span><span class=punctuation.delimiter>.</span><span class=function>method</span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>.</span><span class=function>as_str</span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>.</span><span class=function>to_string</span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>,</span>
</span><span class=line>            <span class=variable>path</span>: <span class=parameter>req</span><span class=punctuation.delimiter>.</span><span class=function>path</span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>.</span><span class=function>to_string</span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>,</span>
</span><span class=line>        <span class=punctuation.bracket>}</span><span class=punctuation.bracket>)</span>
</span><span class=line>    <span class=punctuation.bracket>}</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span><span class=line>
</span><span class=line><span class=keyword>async</span> <span class=keyword.function>fn</span> <span class=function>show_info</span><span class=punctuation.bracket>(</span><span class=keyword>mut</span> <span class=parameter>req</span>: <span class=type>Request</span><span class=punctuation.bracket>)</span> <span class=operator>-></span> <span class=type>Result</span><span class=punctuation.bracket><</span><span class=type>Response</span><span class=punctuation.bracket>></span> <span class=punctuation.bracket>{</span>
</span><span class=line>  <span class=keyword>let</span> <span class=variable>req_info</span> <span class=operator>=</span> <span class=parameter>req</span><span class=punctuation.delimiter>.</span><span class=function>extract</span><span class=punctuation.delimiter>::</span><span class=punctuation.bracket><</span><span class=type>RequestInfo</span><span class=punctuation.bracket>></span><span class=punctuation.bracket>(</span><span class=punctuation.bracket>)</span><span class=punctuation.delimiter>.</span><span class=keyword.return>await</span>?<span class=punctuation.delimiter>;</span>
</span><span class=line>  <span class=type>Ok</span><span class=punctuation.bracket>(</span><span class=type>Response</span><span class=punctuation.delimiter>::</span><span class=function>text</span><span class=punctuation.bracket>(</span><span class=function.macro>format</span><span class=function.macro>!</span><span class=punctuation.bracket>(</span><span class=string>"info: {req_info:#?}"</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span><span class=punctuation.bracket>)</span>
</span><span class=line><span class=punctuation.bracket>}</span>
</span></code></pre></div><div class=page-nav><a class=prev-link href=/docs/0.4.x/concepts/routing><span class=desc><i class="block i-lucide-chevron-left w-3 h-3"></i> Previous</span><span class=title>Routing</span></a><a class=next-link href=/docs/0.4.x/concepts/server><span class=desc>Next <i class="block i-lucide-chevron-right w-3 h-3"></i></span><span class=title>Server</span></a></div></article><nav class="flex-col gap-5 hidden lg:flex"><div class="py-1 text-2 uppercase">On this page</div><ul class=text-3><li><a class="block py-1 font-normal transition-colors op75 hover:op100"href=#interface-definition>Interface definition</a></li><li><a class="block py-1 font-normal transition-colors op75 hover:op100"href=#extraction-functions>Extraction functions</a></li><li><a class="block py-1 font-normal transition-colors op75 hover:op100"href=#custom-types>Custom Types</a></li></ul></nav>